<div class="modal-overlay" *ngIf="isOpen" (click)="onBackdropClick($event)">
  <div class="modal-content" (click)="onModalContentClick($event)">
    <div class="modal-header">
      <h2>Create New Portfolio</h2>
      <button class="close-btn" (click)="onClose()" title="Close">
        <span>×</span>
      </button>
    </div>

    <div class="modal-body">
      <!-- Client Information -->
      <div class="client-info" *ngIf="selectedClient">
        <h3>Client Information</h3>
        <div class="client-details">
          <div class="client-name">{{ selectedClient.name }}</div>
          <div class="client-email">{{ selectedClient.email }}</div>
          <div class="client-tags">
            <span class="tag risk-tag">Risk: {{ selectedClient.riskTolerance }}</span>
            <span class="tag goal-tag">{{ selectedClient.investmentGoals }}</span>
          </div>
        </div>
      </div>

      <!-- General Error Messages -->
      <div class="error-messages" *ngIf="errors.length > 0">
        <div class="error-item" *ngFor="let error of errors">
          <span class="error-icon">⚠️</span>
          {{ error }}
        </div>
      </div>

      <!-- Portfolio Form -->
      <form (ngSubmit)="onSubmit()" class="portfolio-form">
        <div class="form-group">
          <label for="portfolioName">Portfolio Name *</label>
          <input 
            type="text" 
            id="portfolioName"
            name="portfolioName"
            [(ngModel)]="portfolioName"
            placeholder="Enter portfolio name"
            [disabled]="isSubmitting"
            (focus)="onPortfolioNameFocus($event)"
            required
          >
          <div class="field-error" *ngIf="fieldErrors['portfolioName']">
            {{ fieldErrors['portfolioName'] }}
          </div>
        </div>

        <div class="form-group">
          <label for="accountType">Account Type *</label>
          <select 
            id="accountType"
            name="accountType"
            [(ngModel)]="accountType"
            [disabled]="isSubmitting"
            required
          >
            <option value="">Select account type</option>
            <option *ngFor="let type of accountTypes" [value]="type.value">
              {{ type.label }}
            </option>
          </select>
          <div class="field-error" *ngIf="fieldErrors['accountType']">
            {{ fieldErrors['accountType'] }}
          </div>
        </div>

        <div class="form-group">
          <label for="totalValue">Total Portfolio Value *</label>
          <div class="currency-input">
            <span class="currency-symbol">$</span>
            <input 
              type="number" 
              id="totalValue"
              name="totalValue"
              [(ngModel)]="totalValue"
              placeholder="0.00"
              min="0"
              step="0.01"
              [disabled]="isSubmitting"
              (focus)="onTotalValueFocus($event)"
              required
            >
          </div>
          <div class="field-error" *ngIf="fieldErrors['totalValue']">
            {{ fieldErrors['totalValue'] }}
          </div>
          <small class="form-hint">Enter the total value including cash and investments</small>
        </div>

        <div class="form-actions">
          <button 
            type="button" 
            class="btn btn-secondary cancel-btn" 
            (click)="onClose()"
            [disabled]="isSubmitting"
          >
            Cancel
          </button>
          <button 
            type="submit" 
            class="btn btn-primary submit-btn"
            [disabled]="isSubmitting"
          >
            <span *ngIf="!isSubmitting">Create Portfolio</span>
            <span *ngIf="isSubmitting" class="loading-text">
              <span class="spinner"></span>
              Creating...
            </span>
          </button>
        </div>
      </form>
    </div>
  </div>
</div> 